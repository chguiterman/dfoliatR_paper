\documentclass[review]{elsarticle} %review=doublespace preprint=single 5p=2 column
%%% Begin My package additions %%%%%%%%%%%%%%%%%%%
\usepackage[hyphens]{url}

  \journal{Tree-Ring Research} % Sets Journal name


\usepackage{lineno} % add
  \linenumbers % turns line numbering on
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage{graphicx}
\usepackage{booktabs} % book-quality tables
%%%%%%%%%%%%%%%% end my additions to header

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \usepackage{fontspec}
  \ifxetex
    \usepackage{xltxtra,xunicode}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{€}
\fi
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\bibliographystyle{elsarticle-harv}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={dfoliatR: An R package for detection and analysis of insect defoliation signals in tree rings},
            colorlinks=false,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls

\setcounter{secnumdepth}{0}
% Pandoc toggle for numbering sections (defaults to be off)
\setcounter{secnumdepth}{0}


% Pandoc header

\usepackage{amsmath}

\begin{document}
\begin{frontmatter}

  \title{\emph{dfoliatR}: An R package for detection and analysis of insect
defoliation signals in tree rings}
    \author[a,b]{Christopher H. Guiterman\corref{1}}
   \ead{chguiterman@email.arizona.edu} 
    \author[a,c]{Ann M. Lynch}
   \ead{lyncha@email.arizona.edu} 
    \author[c]{Jodi N. Axelson}
   \ead{jodi.axelson@berkeley.edu} 
      \address[a]{Laboratory of Tree-Ring Research, University of Arizona, 1215 E Lowell
St.~Box 210045, Tucson, AZ, 85721}
    \address[b]{Three Pines Forest Research, LLC, PO Box 225, Etna, NH, 03750}
    \address[c]{U.S. Forest Service, Rocky Mountain Research Station, 1215 E Lowell
St.~Box 210045, Tucson, AZ, 85721}
    \address[d]{Dept of Environmental Science, Policy \& Management, University of
California, Berkeley, Berkeley, CA 94720}
      \cortext[1]{Corresponding Author}
  
  \begin{abstract}
  We present a new R package to provide dendroecologists with tools to
  identify, quantify, analyze, and visualize growth suppression events in
  tree rings produced by insect defoliation. The `dfoliatR' library is
  based on the Fortran V program OUTBREAK, and builds on existing
  resources in the R computing environment. `dfoliatR' expands on OUTBREAK
  to provide greater control of supression thresholds, additional output
  tables, and high-quality graphics. To use `dfoliatR' requires
  standardized ring-width measurements from insect host trees and an
  indexed tree-ring chronology from local non-host trees. It performs an
  indexing procedure to remove the climatic signal represented in the
  non-host chronology from the host-tree series. It then infers
  defoliation events in individual trees. Site-level analyses identify
  outbreak events that synchronously affect a user-defined number or
  proportion of the host trees. Functions are available for summary
  statistics and graphics of tree- and site-level series.
  
  \hfill\break
  \end{abstract}
   \begin{keyword} Dendroecology, spruce budworm, Choristoneura, pandora moth, Coloradia
pandora Blake, larch-bud-moth \newpage\end{keyword}
 \end{frontmatter}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

The \texttt{dfoliatR} library adds to a growing suite \texttt{R}
packages designed for dendrochronology. Stemming from the \texttt{dplR}
library (Bunn 2008) that enables \texttt{R} users to read and write an
array of tree-ring data formats, standaridize ring widths, build and
evaluate chronologies, perform qaulity control (to name a few), one can
now also measure ring widths (Lara et al. 2015, Shi and Xiang 2019),
perform and check crossdating (Bunn 2010), and perform many analytical
tests (Zang and Biondi 2015, Jevšenak and Levanič 2018). Tools for
assessing stand dynamics and disturbance analyses are under rapid
development, with new packages for assessing growth and release events
(\texttt{TRADER}: Altman et al. 2014), metrics of growth resilience
(\texttt{pointRes}: Maaten-Theunissen et al. 2015), and fire history
(\texttt{burnr}: Malevich et al. 2018). The key objective of
\texttt{dfoliatR} is to provide tools to identify and analyse insect
defoliation and outbreak events by building on the methods employed the
FORTRAN program OUTBREAK (Swetnam and Lynch 1989). What sets
\texttt{dfoliatR} apart from packages such as \texttt{TRADER} is that it
explicitly performs an indexing procedue on host-tree series to remove
climatic and other non-defoliation related signals represented by
non-host tree species. Insect defoliation signals are identified in the
disturbance index by the duration and magnitude of negative departures.

\texttt{dfoliatR} draws upon data formats in \texttt{dplR} that are
commonly employed by other tree-ring libraries. It uses and outputs data
formats that faciliate the use packages embodied by \texttt{tidyverse}
(Wickham et al. 2019) that include efficient data manipulation
(\texttt{dplyr}: Wickham et al. 2020) and graphics (\texttt{ggplot2}:
Wickham 2016).

In this paper, we describe the statistical methods employed by
\texttt{dfoliatR}, its availability, and run through analyses for a
signle site in New Mexico. Users need not have much experience in
\texttt{R} to replicate the analyses and graphics below. All \texttt{R}
code presented below is executatable in an \texttt{R} session once the
required libraries are installed and loaded. Support documentation in
addition to this paper is provided within the package via standard help
menus (accessed by typing \texttt{?} before a function name) and on the
package website (\url{https://chguiterman.github.io/dfoliatR/}), which
includes up-to-date vignettes that describe in detail the functionality
of the software. Code to create a preprint of this manuscript including
the \texttt{R} scripts is available from
\url{https://github.com/chguiterman/dfoliatR_paper}.

\hypertarget{overview-of-the-software}{%
\section{Overview of the software}\label{overview-of-the-software}}

The \texttt{dfoliatR} library requires two sets of tree-ring data to
identify defoliation and outbreak events:

\begin{itemize}
\tightlist
\item
  Standardized ring-width series for individual trees of the host
  species
\item
  Standardized tree-ring chronology from a local non-host species
\end{itemize}

Users can develop these data sets in software of their choosing, such as
\texttt{dplR} or ARSTAN. It is important that the host-tree data include
only one tree-ring series per tree. Both \texttt{dplR} and ARSTAN have
options for averaging mutliple sample series into a tree-level series.
The tree-ring series and chronology can be read into \texttt{R} via
several available \texttt{dplR} functions.

At the hear of \texttt{dfoliatR} lies two functions:
\texttt{defoliate\_trees()} and \texttt{outbreak()}. These identify
defoliation event son individual trees and thenc omposite across
mutliple trees for a given site to identify outbreak events. It is up to
the researcher to distinguish these separate spatial scales of analysis,
\texttt{dfoliatR} then provides a set of functions to visualize and
statistically summarize tree-level defoliation and site-level outbreak
events, which will be discussed further.

\hypertarget{identifying-defoliation-of-trees}{%
\subsection{Identifying Defoliation of
Trees}\label{identifying-defoliation-of-trees}}

The \texttt{defoliate\_trees()} function will usually be used first. It
performs two processes: removing the non-defoliatation growth signal
from the host-tree series and identifying defoliation events for each
host tree. The climatic or non-defoliation signals in each host-tree
series is represented by the non-host chronology or a climate
reconstruction. This indexing procedure generates the ``growth
suppression index'' (GSI) in which disturbance is the predominant
signal. The GSI is calculated as in Swetnam et al. (1985) and Swetnam
and Lynch (1989), \begin{align}
\textrm{GSI}_{i} = \textrm{H}_{i} - \left( \textrm{NH}_{i} - \overline{\textrm{NH}} \right) \frac{\sigma_{\textrm{H}}}{\sigma_{\textrm{NH}}} \
\end{align} where H and NH are the host tree series and the non-host
chronology, in year i, respectively. Only the common period between each
host-tree series and the non-host chronology are used in Equation 1. The
non-host chronology is scaled by its mean
(\(\overline{\textrm{NH}} \approx 1.0\)) and multiplied by the ratio of
host and non-host standard deviations
(\(\frac{\sigma_{\textrm{H}}}{\sigma_{\textrm{NH}}}\)), which
approximates the variance of the host tree series. This ``corrected''
non-host chronology is subtracted from the host-tree series.

Negative departures in the normalized GSI that surpass user-defined
thresholds in duration and magnitude are defined as \emph{defoliation
events}. As in OUTBREAK, defoliation events have a single year of
maximum departure (the variable `max\_reduction' in
\texttt{defoliate\_trees()}) that is used to assess the magnitude of
growth suppression. The default setting is -1.28 (in units of standard
deviation), which was previously determined as representative of WSBW
effects (\textbf{cite}). Duration is assessed by examining sequences of
negative GSI before and after the year of maximum departure. Each
defoliation event is allowed one positive excersion on each side of the
maximum departure year. Duration is assessed across the entire sequence
that includes up to two positive excursions. The default duration is
eight years, following OUTBREAK, as is commonly used in WSBW studies
(\textbf{cite}). Defoliator insects vary in their durations of
defoliations and outbreaks, so researchers should exmaine their data and
perform sensitivity tests to to find a representative event duration.

Researchers are given the options to extend defoliation events by
bridging between successive events and allowing potentially
short-duration events that occur at the end of the series. Bridging
allows multiple events that are separated by a single year to be
combined and considered as one defolaition event. Each may have up to
five years with positive growth (\textbf{CHECK}). Series end events is
an option that can be used when the trees were sampled during a known
defoliation event, which in many cases is what led the to the site being
sampled for the reconstruction. This option eliminates the duration
parameter, but all other thresholds, and bridging, still apply. These
options are not available in OUTBREAK.

\hypertarget{identifying-outbreak-events}{%
\subsection{Identifying Outbreak
Events}\label{identifying-outbreak-events}}

The individual tree defoliation series are composited in an additional
step to identify \emph{outbreak events} that synchronously affect
mutliple trees. Users have options to define the number and/or the
proportion of trees required for a defoliation event to be considered an
outbreak.

\hypertarget{availability-and-installation}{%
\section{Availability and
installation}\label{availability-and-installation}}

The \texttt{dfoliatR} is provided free and open source (Guiterman 2020).
It is provided to \texttt{R} users via the Comprehensive R Archive
Network (CRAN; \url{https://cran.r-project.org/}). To install
\texttt{dfoliatR} from CRAN use

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{"dfoliatR"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

In each \texttt{R} session, \texttt{dfoliatR} can be loaded via

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dfoliatR)}
\end{Highlighting}
\end{Shaded}

Development versions of \texttt{dfoliatR} are available on Github and
installed using the \texttt{devtools} library,

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{devtools}\OperatorTok{::}\KeywordTok{install_github}\NormalTok{(}\StringTok{"chguiterman/dfoliatR"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Issues, bug reports, and ideas for improving \texttt{dfoliatR} can be
posted to \url{https://github.com/chguiterman/dfoliatR/issues}. As an
Open Source library, we welcome and encourage community involvement in
future development. The best ways to contribute to \texttt{dfoliatR} are
through standard Github procedures or by contacting the first author.

\hypertarget{example-usage}{%
\section{Example Usage}\label{example-usage}}

\hypertarget{tree-level-defoliation-events}{%
\subsection{Tree-level defoliation
events}\label{tree-level-defoliation-events}}

\hypertarget{site-level-events}{%
\subsection{Site-level events}\label{site-level-events}}

\hypertarget{evaluation}{%
\section{Evaluation}\label{evaluation}}

\hypertarget{extensions}{%
\section{Extensions}\label{extensions}}

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\leavevmode\hypertarget{ref-Altman2014}{}%
Altman, J., P. Fibich, J. Dolezal, and T. Aakala. 2014. TRADER: A
package for Tree Ring Analysis of Disturbance Events in R.
Dendrochronologia 32:107--112.

\leavevmode\hypertarget{ref-Bunn2008}{}%
Bunn, A. G. 2008. A dendrochronology program library in R (dplR).
Dendrochronologia 26:115--124.

\leavevmode\hypertarget{ref-Bunn2010}{}%
Bunn, A. G. 2010. Statistical and visual crossdating in R using the dplR
library. Dendrochronologia 28:251--258.

\leavevmode\hypertarget{ref-chris_guiterman_2020_3626136}{}%
Guiterman, C. 2020. Chguiterman/dfoliatR: First release. Zenodo.

\leavevmode\hypertarget{ref-Jevsenak2018}{}%
Jevšenak, J., and T. Levanič. 2018. dendroTools: R package for studying
linear and nonlinear responses between tree-rings and daily
environmental data. Dendrochronologia 48:32--39.

\leavevmode\hypertarget{ref-Lara2015}{}%
Lara, W., F. Bravo, and C. A. Sierra. 2015. MeasuRing: An R package to
measure tree-ring widths from scanned images. Dendrochronologia
34:43--50.

\leavevmode\hypertarget{ref-VanderMaaten-Theunissen2015}{}%
Maaten-Theunissen, M. van der, E. van der Maaten, and O. Bouriaud. 2015.
PointRes: An R package to analyze pointer years and components of
resilience. Dendrochronologia 35:34--38.

\leavevmode\hypertarget{ref-Malevich2018}{}%
Malevich, S. B., C. H. Guiterman, and E. Q. Margolis. 2018. burnr: Fire
history analysis and graphics in R. Dendrochronologia 49:9--15.

\leavevmode\hypertarget{ref-Shi2019}{}%
Shi, J., and W. Xiang. 2019. MtreeRing: A shiny application for
automatic measurements of tree-ring widths on digital images.

\leavevmode\hypertarget{ref-Swetnam1989}{}%
Swetnam, T. W., and A. M. Lynch. 1989. A tree-ring reconstruction of
western spruce budworm history in the southern Rocky Mountains. Forest
Science 35:962--986.

\leavevmode\hypertarget{ref-Swetnam1985}{}%
Swetnam, T. W., M. A. Thompson, and E. K. Sutherland. 1985. Using
dendrochronology to measure radial growth of defoliated trees. Page 39p.

\leavevmode\hypertarget{ref-wickham2016ggplot2}{}%
Wickham, H. 2016. Ggplot2: Elegant graphics for data analysis. Springer.

\leavevmode\hypertarget{ref-Wickham2019}{}%
Wickham, H., M. Averick, J. Bryan, W. Chang, L. McGowan, R. François, G.
Grolemund, A. Hayes, L. Henry, J. Hester, M. Kuhn, T. Pedersen, E.
Miller, S. Bache, K. Müller, J. Ooms, D. Robinson, D. Seidel, V. Spinu,
K. Takahashi, D. Vaughan, C. Wilke, K. Woo, and H. Yutani. 2019. Welcome
to the tidyverse. Journal of Open Source Software 4:1686.

\leavevmode\hypertarget{ref-Wickham2020dplyr}{}%
Wickham, H., R. François, L. Henry, and K. Müller. 2020. Dplyr: A
grammar of data manipulation.

\leavevmode\hypertarget{ref-Zang2015}{}%
Zang, C., and F. Biondi. 2015. Treeclim: An R package for the numerical
calibration of proxy-climate relationships. Ecography 38:431--436.


\end{document}


